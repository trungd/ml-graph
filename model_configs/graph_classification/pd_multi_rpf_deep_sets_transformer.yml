backend: pytorch
random_seed: 42
env:
  default:
    variables:
      batch_size: 256
      hidden_dim: 64
      num_layers: 4
      attn_num_layers: 2
      dropout: 0.2
      learning_rate: 0.01
      num_heads: 8
  nci:
    default: false
    variables:
      dataset:
        - NCI1
        #- NCI109
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15.16
      hidden_dim: 64
      signature: [rpf, rpf_lbl]
      #learning_rate: 0.05
    report:
      type: raw
      reduce: []
  dd:
    default: false
    variables:
      dataset: [DD]
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      signature: [rpf, rpf_lbl]
      batch_size: 64
  proteins:
    default: false
    variables:
      dataset: [PROTEINS]
      feature_name:
        - multi_rpf_1
        - multi_rpf_1.2
        - multi_rpf_1.2.3
        - multi_rpf_1.2.3.4
        - multi_rpf_1.2.3.4.5
        - multi_rpf_1.2.3.4.5.6
        - multi_rpf_1.2.3.4.5.6.7
        - multi_rpf_1.2.3.4.5.6.7.8
        - multi_rpf_1.2.3.4.5.6.7.8.9
        - multi_rpf_1.2.3.4.5.6.7.8.9.10
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15.16
      signature: [rpf_lbl]
  enzymes:
    default: false
    variables:
      dataset: [ENZYMES]
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: [32, 64]
      signature: [rpf, rpf_lbl]
    report:
      type: raw
      reduce: [dropout]
  ptc:
    default: false
    variables:
      dataset:
        - PTC_MR
        - PTC_FR
        - PTC_MM
        - PTC_FM
      feature_name:
        #- multi_rpf_1
        - multi_rpf_1.2.3.4.5.6.7.8
        #- multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15.16
        #- multi_rpf_2.4.6
        #- multi_rpf_3.6.9
      hidden_dim: 32
      num_epochs: 200
      batch_size: 512
      signature: [rpf, rpf_lbl]
  mutag:
    default: false
    variables:
      dataset: [MUTAG]
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: 32
      signature: [rpf, rpf_lbl]
  reddit:
    default: false
    variables:
      dataset:
        - REDDIT-BINARY
        #- REDDIT-MULTI-5K
        #- REDDIT-MULTI-12K
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: [64, 128]
      signature: [rpf]
      batch_size: 64
      num_heads: 4
  reddit5k:
    default: false
    variables:
      dataset:
        - REDDIT-MULTI-5K
        #- REDDIT-MULTI-12K
      feature_name:
        - freq_multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: [64, 128]
      signature: [rpf]
      batch_size: 32
      learning_rate: 0.05
      num_epochs: 250
  imdb:
    default: false
    variables:
      dataset:
        - IMDB-BINARY
        #- IMDB-MULTI
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: [64, 128]
      signature: rpf
  collab:
    default: false
    variables:
      dataset: COLLAB
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: [64, 128]
      signature: rpf
      batch_size: 64
  cox2:
    default: false
    variables:
      dataset: COX2
      feature_name:
        - multi_rpf_1
        - multi_rpf_1.2
        - multi_rpf_1.2.3
        - multi_rpf_1.2.3.4
        - multi_rpf_1.2.3.4.5
        - multi_rpf_1.2.3.4.5.6
        - multi_rpf_1.2.3.4.5.6.7
        - multi_rpf_1.2.3.4.5.6.7.8
        - multi_rpf_1.2.3.4.5.6.7.8.9
        - multi_rpf_1.2.3.4.5.6.7.8.9.10
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15
        - multi_rpf_1.2.3.4.5.6.7.8.9.10.11.12.13.14.15.16
      signature: [rpf_lbl]
      hidden_dim: 64
  dhfr:
    default: false
    variables:
      dataset: [DHFR]
      feature_name:
        - multi_rpf_1.2.3.4.5.6.7.8
      signature: [rpf, rpf_lbl]
  frank:
    default: false
    variables:
      dataset:
        - FRANKENSTEIN
      feature_name:
        - multi_rpf_1
        - multi_rpf_2.4.6.8
        - multi_rpf_1.3.5.7
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: 32
      dense_dim: 32
      signature: [rpf]
    report:
      type: raw
      reduce: []
  synthetic:
    default: false
    variables:
      dataset:
        - SYNTHETIC
      feature_name:
        - multi_rpf_1
        - multi_rpf_2.4.6.8
        - multi_rpf_1.3.5.7
        - multi_rpf_1.2.3.4.5.6.7.8
      hidden_dim: 64
      dense_dim: 64
      signature: [rpf, rpf_lbl]
    report:
      type: raw
      reduce: []
model:
  name: src.models.set_transformer.MultiDeepSetsTransformer
  hidden_dim: ~hidden_dim
  num_layers: ~num_layers
  encoder:
    dim_model: ~hidden_dim
    num_heads: ~num_heads
    num_layers: ~attn_num_layers
  dense_dim: ~hidden_dim
  dropout: ~dropout
dataset:
  name: src.datasets.grakel.Grakel
  dataset_name: ~dataset
  graph_kernel: bottleneck_distance
  graph_features:
    persistence_diagram:
      type: persistence_diagram
      key: ~feature_name
      filtration: vertex_weight
      signature: ~signature
      reuse: true
  test_size: 0.1
train:
  num_epochs: 500
  early_stop:
    num_epochs: 50
  batch_size: ~batch_size
  optimizer:
    name: adam
    lr: ~learning_rate
  lr_scheduler:
    # milestones: [15, 30, 45, 60]
    milestones: [25, 50, 75, 100, 125, 150]
    gamma: 0.5
  cross_validation: 10
test:
  metrics: [acc]